#include <iostream>
#include <string>
#include "funciones.h"
#include "aleatorio.h"
#include "RSA.h"
#include <NTL/ZZ.h>
using namespace std;
using namespace NTL;

using namespace std;

int main()
{
    /*RSA receptor(1024);
    receptor.descifrado("0077254041248384465367680177594259642913719722358927729308484411978610299492669262857221253392603203285079879658785180403205845242840018639177131684887850935237180599927368817703259343719833764669697818723129105463376536400732093937437459143010148645594612529871920352585122174270560774845618054238426789652590065097185052285744094821688262638915282099453655755779347511686403616872270204900629749923074593464700131016061114504549585279473599951234218381979053400417568260072963488594912062916389712515399836217554700824497736839151463686737444287207963472150795418102526225950989378020087414782129941047736341591370500979201158609215714093539673035253758380751261227115423497192664153275944646608723800829426989372459890452621623507646142634716026995345522511886379643796566529488723053533604587083955154969608853621656133951059865437995191282429597279606179815773876683763220478127512076979319013926673585687527403015020923131144073750670991500037230648158038863761090501569853449466462757975569390058741187127156392910990082997267037717486709405422274488267744267676349122019542025012997299772226891106949264606014098324962932591598180496782930345026615714532052334748049125588994098366327074943348141256884938003435406149835933832");
    //*/
    ///RSA EMISOR(E,N)
    /*ZZ n=conv<ZZ>("15797965527125379554895451884980503128283501264067180811602973361605815492417140248938992156520385401127509616818400436058641353273148053920905946275909616422117591834810174080280415835073918925915449555540803821466083729608952430945443417552740478349871590109748748031389298399449104890233941379117292949195530466330927205654650234511046614491786471752713765775872756724121772444754621884866185651306615820507558013614946291466376534642372458765420132473707378628673897790352451168740168234378558645864138591663211547334332208365852955079332681957980798299761279420424853403315120033115594268475184373898700327667101");
    ZZ e=conv<ZZ>("118831771744614267884036168004006690066504645352011370129391916764391780293048861973550184496682081579622056644769615336918162659304713710594754645459116635721407805930018503066008815302178554106599701452495570354353770312280468040655537534370080874682166156791589728565770080678017522614928691686579641699591");
    RSA emisor(e,n);
    emisor.cifrado("nariyamanu ai o sakebu yosubete o daitekoko ni irundahikari wa soko ni aru yoyuzurenai omoi o kaketekibou no hate oboku wa ikiru yoyume o tsunaida kimi tohajimari wo itsuka bokura no te de umidasunda yoyasashii kimi no koe mo kitto sekai wo kaerarerudare mo hitorikiri jatachiagare yashinai karatagai ni te wo nobashitekagiri no koeta ashita enariyamanu ai wo sakebu yobutsukariatte wakariaundahikari wo tsukuridasu yoakiramenu omoi o kaketekibou no hate oboku wa ikiru yoyume o tsunai da kimi toayamachi o osorete dareka wo semete shimau tabihontouni mitsumerubeki wa jibun da to kizuku yokimi ga boku o kaetakotoba ga kokoro ugokasumada minu akogare wotakamaru mune ni motometemakiokoru omoi no kaze gamabuta no oku deatsuku yureta yokimi wa furikaeranaikagayaita hibi o tabidachikibou no hate nifumidashiteikuyume wo tsunaida kimi tokanashimi ni maketakunain da yoikari ni uchikachitaida yoyuragu morosa mo mukiatte koetaindadakara boku wa kimi ni iundatatoe dare ka ga waraou tomotomo ni ikiru sono koe wo mamori tsuzukarunariyamanu ai wo sakebu yosubete wo daitekoko ni irun dahikari wa soko ni aru yoyuzure nai omoi o kaketekibou no hate woboku wa ikiru yoyume wo tsunaida kimi tokimi to");

    */

    /*RSA Alice(0), Bob(0);
    RSA AliceEmisor(ZZ(571),ZZ(58241));
    RSA BobEmisor(ZZ(1409),ZZ(1314727));

    Alice.n=ZZ(1314727);
    Alice.e=ZZ(1409);
    Alice.d=ZZ(311105);

    Bob.n=ZZ(58241);
    Bob.e=ZZ(571);
    Bob.d=ZZ(53239);

    /**
    Emisor Cifro con d, cifro con datos receptor


    cout<<endl<<endl;
    string aux = Alice.cifroConD(Alice.bloques("alegriaMiracoulusLadybug"));
    cout<<"cifrado con D: "<<aux<<endl;
    cout<<AliceEmisor.completarCeros(aux)<<endl;
    aux = AliceEmisor.cifrado(AliceEmisor.completarCeros(aux));
    cout<<"cifrado completo: "<<aux<<endl;
    cout<<"descifrado pt1"<<Bob.descifrado(aux)<<endl;
    //ZZ a= conv<ZZ>(Bob.descifrado(aux).c_str());
    cout<<"descifrado final"<<BobEmisor.descifroConE(Bob.descifrado(aux))<<endl;

    RSA emisor(1024);*/




    RSA emisor(1024);
    ZZ n=conv<ZZ>("20277370801534753382821495234035442778757233211149233976452120434498427529417478936875636128572693669839972760569823589404192675733413974188225200810716907021608624612238795357280565658889717043523184383596752027193819824395447529305703710088880825066002165845549446678712742470072857671296268420261721444445806651323707106502601039431210025525114717819062221823249993385919193720283239311955267970138683736214514761066627997906996778610251210071716344470434314292629140027935293228037870054248601601347977896522508058149756472905662464571594008775790203314997865551235637247379131492251390183445834245020667545805717");
    ZZ e=conv<ZZ>("93143256852327905541154997250672662111591254628363132554785588965138784497734137671290648112252499847254417427895517800380514979908224171216227175519946546390917746106580710819656970760250121608762131666378389468604814416798074624061051160198354226696224926445834891783014316747545909563807660165959137908331");

      string enviar ="I had a great weekend. On Friday afternoon, I finished work at 5 PM. I went home and took a shower. Then I went to see a couple of my friends at a bar downtown. We had a couple of beers and a nice talk. Tom told us about his new job, and Jim told us about his new girlfriend. After a while, we went to a restaurant and had pizza. I went to bed late that night, but I was very happy. On Saturday morning I went running in the park. I ran 5 kilometers, and then came home. After that, I met my girlfriend for lunch. We went to a Thai restaurant near my house. I love Thai food I spent the evening with my girlfriend, watching TV on the sofa. The next day, I got up and caught the train to my parents town. I usually go to see my parents on Sundays, at least twice a month. My mom usually makes a roast, and we go for a walk in the park or in the country after lunch. This weekend was a bit different, though. My parents took me out for a nice lunch, because it was my birthday. After lunch, we took a walk (as usual) and then I caught the train back to London.";
      string mensaje ="21055651316620202077945120215896020127237578200714049189223889425995191766849165196963799546734260626574277700505010888392126939028852394488137868817326002921848504590762941044280311614821303481509769337439210190388004139268891720395077556224838692183300012211085521484140818682231432302256777725965362439641359031078134825631850791429168485710311802175258563806085666219859822852626809903491242940395906407916670798336866343798459892497829106241479184891530402653261068965905407053061397111301669870535885404753912179243309853344155966972522865571090627336806596808648350810515816413484643722403404037913235338670102186309812484166937610645703740333777533110283823462005155795495586088784754391964819169010857362834943038074488362431217402689269862069786021262115600862022210119650852873664515768546745204741055861542783033034089800598529471970845826073389474801943635199856657302523340032847076280227940683109886606773750136279423635526901063019399084004719399733860212265559018436404073168476249813802012763268971273493912929343274057596855928970319076769038060734442779486008271802180762517567599591224341478960781276021616178346120518669217339699519096559317036872631340752171531064581203265202984502170994781521723299614652982170545558655480102867105253001679464352059740681455315229782557584810845035234052472130782277305740470847733505291450017519234736691628654242572839326100888916480119672407668548911485174091998651873668307947498326944463982293310751169403400710892031680645885526384583306043892363012320117128539056943306967817286666087736890440726141180575028054472877904209196683490397286877831915744278408105369784519752503496564449258941689901693279842592753427732174559220833672557416993914688551873188700578650902319085744243704767275963000229520583857262088047534582649272987080398155776460810490152598519416887386798297634069698513771915361973576805076823701286253253486513084731455022761362646927635365354623273812965650106327002508503425413834833871022957599435126078634114832471500408765907699205132664602891179446844635571357372044530403391826572116299639387659436165494781160435631466384245610560674667745485684738927032576452258285411243025483387069371030638830141447525263079356795454433235958122810990886716040876085191379836344816947184593036567419437765072666086892567965451511668630826344468273178076238747723865227752704825934949850959012876531727169601436718125932181569801209469752894317557423157690161686608584490163850464444951399";
       emisor.firmarCifrar(enviar,n,e);
      //emisor.DescifrarFirma(mensaje,n,e);
    return 0;
}
